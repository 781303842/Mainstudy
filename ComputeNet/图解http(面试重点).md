# 在地址栏输入url会发生那些事  
- 通过DNS协议拿到对应的ip地址，这里涉及到本地域名服务器和其它域名服务器的交互，有递归和递归迭代结合的方式
- 针对目标ip服务器通过http协议生成http报文结构
- tcp将报文分成多成多个报文段并可靠交给对方
- ip将多个报文段一边查找一边转发
- 接收方的tcp将接收的报文段组合起来，按序号重新组成报文。
- 接收方的http协议对请求方要请求的资源做处理。  

# http 状态码  

|  类别   | 原因短语  |  举例  |
|  ----  | ----  | ---- |
| 1xx（信息类状态码）  | 请求正在处理中 |   |
| 2xx（成功状态码）  | 请求正常处理完毕 | 200（ok） 204（请求成功，响应报文中不含实体的主体部分）   |
| 3xx（重定向状态码）  | 需要执行附加操作才能完成请求 | 301（资源已经被分配新的uri）   |
| 4xx（客户端错误状态码）  | 服务器无法处理请求 |  400（请求报文中存在语法错误）401（需要授权） 403（对请求资源的访问被服务器拒绝了） 404（服务器上无法找到请求的资源）  |
| 5xx（服务端错误状态码）  | 服务端处理请求中出错 |  500（服务器端在执行请求时发生了错误）  |


# http报文结构  
- 请求报文结构：`请求行 方法（get，put，deletedeng） uri http版本`+`首部字段，比如content-type：表示报文主体内容的数据类型等等，keep-alives是否保持持续连接，目的主机名等等`+`报文主体`
- 响应报文结构:`响应行 http版本 状态码`+ `首部字段：data创建报文的时间，accept-range是否接受范围数据请求，server服务器安装信息（apache等）`+`报文主体`
- 请求行或者响应行+首部字段一起称为报文首部

# http和https  
http：超文本传输协议。http的缺点：
- 用明文进行传输，没有对数据加密。  
- 不验证通讯对方的身份，因此可能遭遇到伪装。
- 没有办法确定报文的完整性，可能遭到篡改。
- 后面两个缺点参考中间人攻击，比如AB双方通过对称加密的方式进行通讯，首先该怎么让对方安全的知道密钥的问题先不谈，比如没有处理这个问题，A直接向B发送了加密秘钥，其中秘钥被中间第三方劫持了（没有进行安全处理的话，第一次发送对称加密秘钥是通过明文传输的），那么就算B收到后，知道此后的通讯要用此对称秘钥加密后发送给B，但是此时等于裸奔，因为中间人已经知道了秘钥还是对称的，所以劫持B发给A的报文后，解密，就没有安全性可言，更过分的事中间人可能篡改此报文的数据后再用劫持的秘钥加密后发给A，AB通讯感受不到中间人的存在，此时已经等于裸奔了。   

对应的解决方案：
- 既然http是明文传输，那么如何去实现加密处理防止被窃听。
    + 通讯的加密：HTTP 协议中没有加密机制，但可以通过和 SSL（Secure Socket Layer，安全套接层）或TLS（Transport Layer Security，安全层传输协议）的组合使用，加密 HTTP 的通信内容，这就是HTTPS。也就是ssl+http的组合。在tcp/ip4层模型中，应用层的http直接调用tcp传输，但是ssl相当于加载应用层和tcp中间。
    + 内容的加密：一般是对报文主体进行加密。  
    + 对称加密和非对称加密：对称加密是加密和解密使用的都是同一个密钥文件，非对称加密是通讯双方都有两个密钥（一个公钥一个私钥），一般将公钥发布出去，再通过自己的私钥进行解密）
        - 问题及解决访问1：对称加密没办法保证第一次发送密钥文件时不会被劫持，同时是对称的，也就是一般知道了对称密钥，那么通信双方的通讯内容都被人知道了。所以一般而言的做法，非对称加密就是通过用接收方的公钥来加密对称密钥文件，然后发送给接收方，接收方再用自己的公钥解密。之后两方就通过对称密钥来通信了，为什么这么做？因为非对称加密解密时间比对称加密长。
        - 问题及解决方案2：上面用对称和非对称混合的方式来做，也有问题，就是没办法保证**我用来加密的公钥不一定是接收方的密钥，咋办**，通用做法就是引入一个安全可靠的第三方结构，也就是我们常说的数字证书认证机构（CA，Certificate Authority）和其相关机关颁发的公开密钥证书。参考下图：其中最重要的一点就是CA机构的公钥文件会提前植入到浏览器，这是很重要的，如果没有这点，CA的公钥也不一定和我们要验证数字证书的公钥。  
        ![CA过程](https://github.com/781303842/Mainstudy/blob/master/ALLIMG/CA%E8%BF%87%E7%A8%8B.png)

