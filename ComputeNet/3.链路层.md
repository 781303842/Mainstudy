# 链路层（相邻的两个节点传输）  
主要的功能就是为网络层提供服务，在提供服务的过程中，细化出了很多。
- 比如为了使数据在实际传输的出错的时候更好重发，需要将网络层传递下来的数据`组装成帧（同时帧也是网络中最小的发送数据的单位）`，比如PPP（面向比特流）和HDLC协议（面向字节）
- 组装完过后，还要`帧定界`，单从HDLC协议定义的结构来看`标志位【01111110】+地址【8位】+控制【8位】+信息（N位）+帧校验（16位）+标志位【01111110】`,其中信息有N位，也就是说每一个帧不一定等长，所系还需要进行帧定界
这样接受方在接收数据过后才知道那里是帧的开头哪里是结束。
- 问题接踵而至，如果网络层传递过来的数据中刚好有我们选择协议的标志位（如果协议中需要标志位的，也可以在帧头，放一个计数，但是效果不好），还要做到`透明传输`，用一个转义字符来解决。  
- 好了，封装成帧基本上差不多了；那么可以考虑`流量控制`了，因为如果发送方发的太快，接收方来不及处理，那么发送的数据都将会被丢弃。因此有三种解决思路：
    - 接收方有接收窗口，发送有发送窗口，只有发送窗口内的数据才可以发发送出去，接收的数据落在接收窗口才能被接收。滑动窗口前面的表示已经成功发送，滑动窗口后面的表示不能发送。
    - 停止等待协议：发送窗口=1，接收窗口=1，发送方每发送一帧数据，接收方都要回送一个ack，发送方接收到了确认才会发送下一个数据。
    - 后退N帧（GBN）：发送窗口>1,接收窗口=1。就是发送方可以一直连续发，接收方只要检测到失序的数据，比如应该接收5，却收到了6.那么接收方要求重传最后一次成功确认接收的数据后面的所有数据。
    - 选择重传：发送窗口>1,接收窗口>1。在检测到错误过后，可以选择性的重发错误的数据。而不用向后退N帧一样重发全部。
    
- 最后一个要做的事，就是`差错控制`，有检错和纠错两种，检错的是奇偶校验和循环冗余（CRC），纠错的是海明码。  

- 介质访问（MAC,medium access control）：为什么要做介质访问？`因为实际的信道就那么多，既然保证网络的效率，又要保证不会出现无法接受的冲突。`  
    - 静态控制：  
        + 频分复用：就是将不同频率的信息叠加起来形成一个复合的信号，发送出去。  
        + 时分复用：将物理信道按时间划分，每一个时间只能发送一个数据
        + 波分复用：我觉得有点像频分复用，但是这里信息的载体是光波，通过合波器和分波器完成信息的复用分解。
        + 码分复用：具体实现方式参考码分多址复用。
    - 随机访问控制：  
        + ALOHA：不用冲突检测，直接发，如果一段时间后没接收到确认帧，则认为冲突了，重发数据。
        + 间隙ALOHA：将各个节点的时间同步起来，划分为多个时间段，只有时间段的起点才允许发送数据。尽可能减少了发送数据的随意性，但是还是免不了冲突。
        + CSMA（载波监听协议，1-坚持）：就是发送数据前先监听信道是否空闲，如果空闲，立马发送。如果检测到冲突随机一段时间后再发送
        + CSMA(载波监听协议，非坚持)：就是发送数据前先监听信道是否空闲，如果空闲，立马发送。如果忙放弃监听，随机一段时间后再重复上面的过程。
        + CSMA（载波监听协议，p坚持）：发送数据前先检查信道是否空闲，空闲则以p的概率发送，以1-p的概率推迟到下一轮。
        + CSMA/CD（载波监听多路协议/冲突检测，用于有线连接）：先听先发，边听边发（区别于上面的csma），冲突停发，随机重发。
        + CSMA/CA（避免冲突，用于无线连接）：了解。
        + 轮训（令牌）：令牌帧在环网络中流动，需要发送数据前需要获取令牌帧才能发送数据。  
- 局域网中的帧：IEEE802 局域网的标准只对应iso模型的物理层和链路层，其中逻辑链路子层作用不大，而以太网又在局域网处于垄断地位，所以只剩下了MAC子层。  
    + （mac帧）：`8字节的前同步码+6字节的源MAC地址+6字节的目的MAC地址+2字节的类型+ip数据报+fcs`
- 广域网中的帧：
    + （PPP格式）`标志1字节+地址1字节+控制1字节+协议2字节+ip数据包（不超过1500B）+2字节的FCS检错+标志1字节）`，面向字节
    + （HDLC格式）`标志1字节+地址1字节+控制1字节+ip数据包（可变）+2字节的FCS检错+标志1字节）`，少了2字节的协议控制，面向比特流。
